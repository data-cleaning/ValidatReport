\section{Examples}
\label{sect:examples}
In this Chapter we work out a few examples based on validation reports that are
currently implemented in several NSI's. We are grateful to the NSI's that
provided the examples to  the ESSnet.

\begin{lstlisting}[
  frame=single
  ,linewidth=1.1\textwidth
  ,caption=Part of an extended report based on an example from the Swedish Triton system.
  ,showstringspaces=false
]
{
"nodes" : [
  { 
    "key" : "agg1"
    "value" :  {
      "type": "aggregation",
      "aggregator": {
        "language": "VBA",
        "expression": "COUNT",
        "description": "Totalt antal fel"
      },
      "nodeset": {
        "keys": ["A_20", "A_22", "VM1",
          "...all keys over which counting took place..."
        ],
        "description": ""
      },
      "value": "17"
    }
  },
  {
    "key"    : "A_22",
    "value"  : {
      "type": "confrontation",
      "event": {
        "time": "20150930T104041+0200",
        "actor": "Triton demo 2",
        "agent": null,
        "trigger": null
      },
      "rule": {
        "language": "VBA",
        "expression": "Om (B1; PersonNr10 ; 0 ; 
          T.Substring(KO;9;0;N, KO;1;0;N)) >= (KO;0;T)",
        "severity": "error",
        "description": 
           "A_22 Personnummer måste anges med 10 tekken"
      },
      "data": [
        "invånarna i Sverige",
        "undersökning",
        "5510112641",
        "PersonNr10"
      ],
      "value": "0"
    }
  },
{... the other confrontations ...}
]
}
\end{lstlisting}

\begin{lstlisting}[
  frame=single
  ,linewidth=1.1\textwidth
  ,caption=Part of an extended report based on the assessment of VTL 1.1 - 
    Questionnaire for NAPS statistics (January 2017).
  ,showstringspaces=false
]
{
"nodes" : [
  { 
    "key" : "aggr"
    "value" :  {
      "type": "aggregation",
      "aggregator": {
        "language": "VTL 1.1",
        "expression": "COUNT",
        "description": "Total nr of revisions above threshold"
      },
      "nodeset": {
        "keys": ["WC001", "WC002", "WC003", "WC004"],
        "description": "EU member states"
      },
      "value": "4"
    }
  },
  {
    "key"    : "WC001",
    "value"  : {
      "type": "confrontation",
      "event": {
        "time": "20150930T104041+0200",
        "actor": "Laura Vignola",
        "agent": null,
        "trigger": null
      },
      "rule": {
        "language": "VTL 1.1",
        "expression": "
          ds_esa_current_filt = 
            ds_esa_current [ 
              filter (PRICE = "V” and PRICE = "Y") ];

          ds_esa_previous_filt = 
            ds_esa_previous [ 
              filter (PRICE = "V” and PRICE = "Y") ];

          ds_esa_current_pcent = 
            ds_esa_current_filt [ STO = "P3" ] / 
              ds_esa_current_filt [ STO = "B1GQ" ];

          ds_esa_previous_pcent = 
            ds_esa_previous_filt [ STO = "P3" ] / 
              ds_esa_previous_filt [ STO = "B1GQ" ];

          ds_result_5 := check( abs( 
            ds_esa_current_pcent.obs_value - 
              ds_esa_previous_pcent.obs_value ) ) <= 0.015, 
            errorcode('Deviation larger than 1.5% between 
              revised figures and previous version for 
              the ratio final consumption expenditure / GDP 
              at market price'), 
            errorlevel("Error") ) ;",
        "severity": "error",
        "ESS identifier" : "ESA_5",
        "name" : "Weight check",
        "ref"  : "Eurostat C2/TFVALID/Apr16/005a: check 8",
        "description": "
          For current prices (PRICE='V') and previous year 
          prices (PRICE='Y'), the difference between
          - revised figures of final consumption expenditure 
            (STO='P3') as a % GDP at market price 
            (STO:'B1GQ') 
          - and the same ratio for the previous 
            transmission should not be higher than 1.5% 
          => deviation of 1.5% maximum accepted for the ratio 
            (final consumption expenditure / 
             GDP at market price) in the revised figures."
      },
      "data": [
        [ "prices", "2014Q1-first"  ,"AT",
          "final consumption expenditure"
        ],
        [ "prices","2014Q1-revised","AT",
          "final consumption expenditure"
        ]
      ],
      "value": "0"
    }
  },
{... the other confrontations ...}
]
}
\end{lstlisting}
